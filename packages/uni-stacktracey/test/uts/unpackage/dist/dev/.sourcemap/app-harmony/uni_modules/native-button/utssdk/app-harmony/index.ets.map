{"version":3,"sources":["uni_modules/native-button/utssdk/app-harmony/index.uts","uni_modules/native-button/utssdk/interface.uts"],"sourcesContent":["import { BuilderNode } from \"@kit.ArkUI\"\r\nimport { buildButton } from \"./builder.ets\"\r\n\r\nimport { INativeButtonContext } from \"../interface.uts\"\r\n\r\ninterface NativeButtonOptions {\r\n    text : string\r\n    onClick : () => void\r\n}\r\n\r\nexport class NativeButton {\r\n    private $element : UniNativeViewElement;\r\n    private builder : BuilderNode<[NativeButtonOptions]> | null = null\r\n    private params : NativeButtonOptions = {\r\n        text: '',\r\n        onClick: () => {\r\n            this.$element.dispatchEvent(new UniNativeViewEvent(\"customClick\", {}))\r\n        }\r\n    }\r\n\r\n    constructor(element : UniNativeViewElement) {\r\n        this.builder = element.bindHarmonyWrappedBuilder(wrapBuilder<[NativeButtonOptions]>(buildButton), this.params)\r\n        this.$element = element\r\n    }\r\n\r\n    updateText(text : string) {\r\n        this.params.text = text\r\n        this.builder?.update(this.params)\r\n    }\r\n}\r\n\r\n\r\nclass NativeButtonContext implements INativeButtonContext {\r\n    private element : UniNativeViewElement\r\n    private builder : BuilderNode<[NativeButtonOptions]>\r\n    constructor(element : UniNativeViewElement) {\r\n        this.element = element\r\n        this.builder = element.getHarmonyBuilderNode() as BuilderNode<[NativeButtonOptions]>\r\n    }\r\n    updateText(text : string) {\r\n        this.builder?.update({\r\n            text,\r\n            onClick: () => {\r\n                this.element.dispatchEvent(new UniNativeViewEvent(\"customClick\", {}))\r\n            }\r\n        })\r\n    }\r\n}\r\n/**\r\n * 递归查询\r\n */\r\nfunction iterateElement(homeElement : UniElement) : UniNativeViewElement | null {\r\n    if (\"NATIVE-VIEW\" == homeElement.nodeName) {\r\n        return homeElement as UniNativeViewElement\r\n    }\r\n    for (const perChildEle of homeElement.children) {\r\n        let findEle = iterateElement(perChildEle)\r\n        if (findEle != null) {\r\n            return findEle\r\n        }\r\n    }\r\n\r\n    return null\r\n}\r\n\r\n\r\n\r\nexport function createNativeButtonContext(id : string, ins : ComponentPublicInstance | null = null) : INativeButtonContext | null {\r\n    if (ins == null) {\r\n        const pages = getCurrentPages()\r\n        if (pages.length > 0) {\r\n            const page = pages[pages.length - 1]\r\n            const rootViewElement = page.getElementById(id)\r\n            if (rootViewElement != null) {\r\n                /**\r\n                 * 找到了root节点，递归检索目标 native-view\r\n                 */\r\n                const nativeViewElement = iterateElement(rootViewElement)\r\n                if (nativeViewElement != null) {\r\n                    return new NativeButtonContext(nativeViewElement)\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        /**\r\n         * 尝试迭代遍历\r\n         */\r\n        if (ins.$el != null) {\r\n            const nativeViewElement = iterateElement(ins.$el as UniElement)\r\n            if (nativeViewElemen != null) {\r\n                return new NativeButtonContext(nativeViewElement)\r\n            }\r\n        }\r\n    }\r\n\r\n    return null\r\n}","/**\n * 原生组件的上下文对象\n */\nexport interface INativeButtonContext {\n\t/**\n\t * 更新文本示例\n\t */\n\tupdateText(text : string) : void\n}\n\nexport type CreateNativeButtonContext = (\n\tid : string,\n\tcomponent ?: ComponentPublicInstance | null\n) => INativeButtonContext | null;"],"names":[],"mappings":"AAAA,SAAS,WAAW,QAAQ,aAAY;;AACxC,SAAS,WAAW,QAAQ,YAAe;UCE1B;IAIhB,WAAW,MAAO,MAAM,GAAI,IAAI;;UDFvB;IACN,MAAO,MAAM;IACb,eAAgB,IAAI;;AAGlB,MAAO;IACT,QAAQ,UAAW,qBAAqB;IACxC,QAAQ,SAAU,aAAa,wBAAwB,IAAI,GAAG,IAAI,CAAA;IAClE,QAAQ,QAAS,sBAAsB;QACnC,MAAM;QACN,SAAS,IAAK;YACV,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,IAAI,mBAAmB,iCAAe,CAAA;QACtE;MACH;IAED,YAAY,SAAU,oBAAoB,CAAA;QACtC,IAAI,CAAC,OAAO,GAAG,QAAQ,yBAAyB,CAAC,aAAa,sBAAsB,cAAc,IAAI,CAAC,MAAM;QAC7G,IAAI,CAAC,QAAQ,GAAG;IACpB;IAEA,WAAW,MAAO,MAAM,EAAA;QACpB,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG;QACnB,IAAI,CAAC,OAAO,EAAE,OAAO,IAAI,CAAC,MAAM;IACpC;;AAIJ,MAAM;IACF,QAAQ,SAAU,qBAAoB;IACtC,QAAQ,SAAU,aAAa,sBAAqB;IACpD,YAAY,SAAU,oBAAoB,CAAA;QACtC,IAAI,CAAC,OAAO,GAAG;QACf,IAAI,CAAC,OAAO,GAAG,QAAQ,qBAAqB,MAAM,aAAa;IACnE;IACA,WAAW,MAAO,MAAM,EAAA;QACpB,IAAI,CAAC,OAAO,EAAE,yBAAO;YACjB;YACA,SAAS,IAAK;gBACV,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,mBAAmB,iCAAe,CAAA;YACrE;;IAER;;AAKJ,SAAS,eAAe,aAAc,UAAU,GAAI,uBAAuB,IAAI,CAAA;IAC3E,IAAI,iBAAiB,YAAY,QAAQ,EAAE;QACvC,OAAO,eAAe;KACzB;IACD,KAAK,MAAM,eAAe,YAAY,QAAQ,CAAE;QAC5C,IAAI,UAAU,eAAe;QAC7B,IAAI,WAAW,IAAI,EAAE;YACjB,OAAO;SACV;;IAGL,OAAO,IAAI;AACf;AAIM,SAAU,0BAA0B,IAAK,MAAM,EAAE,KAAM,0BAA0B,IAAI,GAAG,IAAI,0BAA2B,IAAI,CAAA;IAC7H,IAAI,OAAO,IAAI,EAAE;QACb,MAAM,QAAQ;QACd,IAAI,MAAM,MAAM,GAAG,GAAG;YAClB,MAAM,OAAO,KAAK,CAAC,MAAM,MAAM,GAAG,EAAE;YACpC,MAAM,kBAAkB,KAAK,cAAc,CAAC;YAC5C,IAAI,mBAAmB,IAAI,EAAE;gBAIzB,MAAM,oBAAoB,eAAe;gBACzC,IAAI,qBAAqB,IAAI,EAAE;oBAC3B,OAAO,IAAI,oBAAoB;iBAClC;aACJ;SACJ;WACE;QAIH,IAAI,IAAI,GAAG,IAAI,IAAI,EAAE;YACjB,MAAM,oBAAoB,eAAe,IAAI,GAAG,IAAI;YACpD,IAAI,oBAAoB,IAAI,EAAE;gBAC1B,OAAO,IAAI,oBAAoB;aAClC;SACJ;KACJ;IAED,OAAO,IAAI;AACf;AAtFA,SAAa,gBAAA,eAmBZ;AAsCD,SAAgB,6BAAA,4BA6Bf"}