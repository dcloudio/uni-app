{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:////Users/zhangmeng8/Desktop/my-uniaap-repo/demo-project/weibo-uni-app-demo/renderPlugin/web-view/src/index.js"],"names":["WebviewElement","el","document","createElement","iframe","appendChild","hasLoad","addEventListener","mountedQueue","length","map","b","splice","messageCallback","e","source","contentWindow","dispatch","detail","data","iframe_class","name","value","setAttribute","doOnLoad","postMessage","removeAttribute","style","console","error","classNames","type","listener","options","window","removeEventListener","blk","push","Component","ComponentManager","registerComponents"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"../../../../../../Desktop/my-uniaap-repo/demo-project/weibo-uni-app-demo/renderPlugin/web-view/src/index.js\");\n","\nexport default class WebviewElement extends window.Component {\n  render () {\n    const el = document.createElement('iframe-container')\n    this.iframe = document.createElement('iframe')\n    el.appendChild(this.iframe)\n    this.hasLoad = false\n    this.iframe.addEventListener('load', () => {\n      this.hasLoad = true\n      if (this.mountedQueue && this.mountedQueue.length){\n        this.mountedQueue.map(b => b())\n        this.mountedQueue.splice(0, 100000)\n      }\n    })\n    this.messageCallback = (e) => {\n      if (e.source === this.iframe.contentWindow) {\n        this.dispatch(this.iframe, 'message', {\n          detail: {\n            data: e.data\n          }\n        })\n      }\n    }\n    \n    this.iframe_class = ''\n    return el\n  }\n  setAttribute (name, value) {\n    if (name === 'src') {\n      this.iframe.setAttribute('src', value)\n      super.setAttribute(name, value)\n    } else if (name === 'data') {\n      this.doOnLoad(() => {\n        this.iframe.contentWindow.postMessage(value, '*')\n      })\n    } else {\n      this.iframe.setAttribute(name, value)\n    }\n    if (name === 'class') {\n      this.iframe_class = value\n    }\n  }\n  removeAttribute (name) {\n    if (name === 'src') {\n      super.removeAttribute(name)\n    } else {\n      this.iframe.removeAttribute(name)\n    }\n    if (name === 'class') {\n      this.iframe_class = ''\n    }\n  }\n  setStyle (name, value) {\n    // this.iframe.setStyle(name, value)\n    if (name in this.iframe.style) {\n      this.iframe.style[name] = value\n    } else {\n      console.error(`setStyle ${name}: ${value} for web-view is not support`)\n    }\n  }\n  setClass (name, value) {\n    // this.iframe.setClass(name, value)\n    const classNames = this.iframe_class ? `${this.iframe_class} ${value}` : `${value}`\n    this.iframe.setAttribute('class', classNames)\n  }\n  addEventListener (type, listener, options) {\n    if (type === 'iframeSrcChange') {\n      super.addEventListener(type, listener, options)\n    } else {\n      this.iframe.addEventListener(type, listener, options)\n    }\n    if (type === 'message') {\n      window.addEventListener('message',this.messageCallback, false);\n    }\n  }\n  removeEventListener (type) {\n    if (type === 'iframeSrcChange') {\n      super.removeEventListener(type)\n    } else {\n      this.iframe.removeEventListener(type)\n    }\n    if (type === 'message') {\n      window.removeEventListener('message', this.messageCallback);\n    }\n  }\n  unMounted(){\n    window.removeEventListener('message', this.messageCallback);\n  }  \n  doOnLoad (blk) {\n    this.mountedQueue = this.mountedQueue || []\n    if (this.hasLoad) {\n      blk()\n    } else {\n      this.mountedQueue.push(blk)\n    }\n  }\n}\n\n// 默认注册iframe\nwindow.ComponentManager.registerComponents({\n  'wbx-web-view': WebviewElement\n})\n\n"],"sourceRoot":""}